function ret = yuv2rgb(x)

x = x.*255;

Y = x(:,:,1);
U = x(:,:,2);
V = x(:,:,3);

a = [0.229 0.587 0.114; -0.168 -0.331 0.5; 0.5 -0.418 -0.082];
A = [0.257 0.504 0.098; -0.148 -0.291 0.439; 0.439 -0.368 -0.071];

invA = inv(A);

R = invA(1,1)*(Y-16)                     + invA(1,3)*(V-128);
G = invA(2,1)*(Y-16) + invA(2,2)*(U-128) + invA(2,3)*(V-128);
B = invA(3,1)*(Y-16) + invA(3,2)*(U-128);

ret = cat(3,R,G,B)./255;
